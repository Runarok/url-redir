<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Redirector</title>
    <script>
        // Fetch the redirect rules from the JSON file
        async function fetchRedirects() {
            const response = await fetch('redirects.json');
            const redirects = await response.json();
            handleRedirect(redirects);
        }

        // Function to handle the redirection based on the URL hash
        function handleRedirect(redirects) {
            const hash = window.location.hash.substring(1); // Remove the '#' from the hash

            if (redirects[hash]) {
                const redirect = redirects[hash];
                if (redirect.showPopup) {
                    // Show popup if the redirect has popup enabled
                    showPopup(redirect);
                } else {
                    // Redirect immediately if no popup is needed
                    window.location.href = redirect.url;
                }
            } else {
                // Display message if no redirect is found
                document.getElementById('message').innerText = `No redirect found for hash: ${hash}`;
            }
        }

        // Function to show the popup
        function showPopup(redirect) {
            const userConfirmed = confirm(`Do you want to redirect to ${redirect.url}?`);
            if (userConfirmed) {
                window.location.href = redirect.url;
            } else {
                document.getElementById('message').innerText = `Redirect to ${redirect.url} was canceled.`;
            }
        }

        // Call the function to fetch the redirects and process
        window.onload = fetchRedirects;
    </script>
</head>
<body>
    <h1>API Redirector</h1>

    <p>This page acts as an API redirector. If the URL hash matches a predefined fragment, you will be redirected.</p>

    <p id="message">Loading...</p>

    <p>Hosted on GitHub Pages by <strong>Runarok</strong></p>
    <p>Repository: <a href="https://github.com/Runarok/url-redir" target="_blank">url-redir</a></p>
</body>
</html>
